<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark PDF Library</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom CSS for glassmorphism effect */
        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            transition: width 0.3s ease;
        }
        
        /* Animation for cards */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-card {
            animation: fadeIn 0.3s ease forwards;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 4px;
        }
        
        /* PDF viewer modal */
        .pdf-modal {
            transition: all 0.3s ease;
        }
        
        .pdf-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
        }

        /* Fullscreen PDF viewer */
        .pdf-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
        }

        .pdf-toolbar {
            padding: 1rem;
            background: rgba(30, 41, 59, 0.9);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .pdf-iframe {
            flex-grow: 1;
            border: none;
        }

        .close-fullscreen {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .close-fullscreen:hover {
            background: #2563eb;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">
    <!-- Mobile menu button -->
    <div class="md:hidden fixed top-4 left-4 z-40">
        <button id="mobileMenuBtn" class="p-2 rounded-full bg-slate-800 text-blue-400 shadow-lg">
            <i class="fas fa-bars text-xl"></i>
        </button>
    </div>

    <!-- Sidebar Navigation -->
    <div id="sidebar" class="sidebar fixed top-0 left-0 h-full w-64 bg-slate-800 overflow-y-auto z-30 p-4 shadow-xl">
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-2xl font-bold text-blue-400">PDF Library</h1>
            <button id="closeSidebarBtn" class="md:hidden p-2 text-slate-400 hover:text-white">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="mb-4 relative">
            <input type="text" id="searchInput" placeholder="Search PDFs..." 
                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <i class="fas fa-search absolute right-3 top-3 text-slate-400"></i>
        </div>
        
        <div class="mb-4">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-lg font-semibold text-slate-300">Categories</h2>
                <button id="expandAllBtn" class="text-xs text-blue-400 hover:text-blue-300">Expand All</button>
            </div>
            
            <div id="categoryAccordion" class="space-y-1">
                <!-- Categories will be populated by JavaScript -->
            </div>
        </div>
        
        <div class="mt-8 pt-4 border-t border-slate-700">
            <h3 class="text-sm font-semibold text-slate-400 mb-2">Progress</h3>
            <div class="space-y-2">
                <div>
                    <div class="flex justify-between text-xs mb-1">
                        <span>Total Completion</span>
                        <span id="totalCompletion">0%</span>
                    </div>
                    <div class="w-full bg-slate-700 rounded-full h-2">
                        <div id="totalProgressBar" class="progress-bar rounded-full h-2" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="md:ml-64 p-4 md:p-6">
        <div class="flex items-center justify-between mb-6">
            <h2 id="currentCategory" class="text-2xl font-bold text-blue-400">All Resources</h2>
            <div class="flex space-x-2">
                <button id="gridViewBtn" class="p-2 rounded-lg bg-slate-800 text-blue-400 hover:bg-slate-700">
                    <i class="fas fa-th-large"></i>
                </button>
                <!-- <button id="listViewBtn" class="p-2 rounded-lg bg-slate-800 text-slate-400 hover:bg-slate-700">
                    <i class="fas fa-list"></i>
                </button> -->
            </div>
        </div>
        
        <!-- PDF Cards Grid -->
        <div id="pdfContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
            <!-- PDF cards will be populated by JavaScript -->
        </div>
        
        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-12">
            <i class="fas fa-file-pdf text-5xl text-slate-700 mb-4"></i>
            <h3 class="text-xl font-semibold text-slate-400">No PDFs found</h3>
            <p class="text-slate-500 mt-2">Try selecting a different category or adjusting your search</p>
        </div>
    </div>
    
    <!-- PDF Viewer Modal -->
    <div id="pdfModal" class="pdf-modal fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="relative w-full max-w-6xl h-full max-h-screen">
            <button id="closePdfModal" class="absolute -top-10 right-0 text-white hover:text-blue-400 text-2xl">
                <i class="fas fa-times"></i>
            </button>
            <div class="glass-card rounded-xl overflow-hidden w-full h-full">
                <iframe id="pdfFrame" class="w-full h-full" frameborder="0" allowfullscreen></iframe>
            </div>
            <div class="flex justify-between items-center mt-4 text-white">
                <span id="pdfTitle" class="font-medium truncate max-w-xs"></span>
                <div class="flex space-x-3">
                    <button id="markAsReadBtn" class="p-2 rounded-full bg-slate-700 hover:bg-slate-600">
                        <i class="far fa-check-circle"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen PDF Viewer -->
    <div id="pdfFullscreen" class="pdf-fullscreen hidden">
        <div class="pdf-toolbar">
            <span id="fullscreenPdfTitle" class="font-medium text-white truncate max-w-md"></span>
            <button id="closeFullscreenBtn" class="close-fullscreen">
                <i class="fas fa-times mr-1"></i> Close
            </button>
        </div>
        <iframe id="fullscreenPdfFrame" class="pdf-iframe" frameborder="0" allowfullscreen></iframe>
    </div>

    <script>
        // Sample JSON data (would normally be loaded from an external file)
        const pdfData =
        [
  {
    "category": "Placement Material",
    "subcategory": "C & DSA Notes",
    "resources": [
      {
        "name": "100 Python Interview Questions",
        "file_link": "https://drive.google.com/file/d/14M-9ZZmD9oAgE1UprFG7ywLpBi9CBCYV/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/14M-9ZZmD9oAgE1UprFG7ywLpBi9CBCYV=s1024?authuser=0"
      },
      {
        "name": "C Code for Raspberry Pi (92 pages)",
        "file_link": "https://drive.google.com/file/d/1jkHSy8VI5u2etxcueN1SbVOpeLkN21l_/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1jkHSy8VI5u2etxcueN1SbVOpeLkN21l_=s1024?authuser=0"
      },
      {
        "name": "Durgasoft Python Book",
        "file_link": "https://drive.google.com/file/d/1FooIbRV12znjKQb7GZhdpSybT8beuhkb/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1FooIbRV12znjKQb7GZhdpSybT8beuhkb=s1024?authuser=0"
      },
      {
        "name": "Algorithm Notes for Professionals (257 pages)",
        "file_link": "https://drive.google.com/file/d/1jGKsnAvI-8A-GOPcaRIU8cwT7vo_WfMB/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1jGKsnAvI-8A-GOPcaRIU8cwT7vo_WfMB=s1024?authuser=0"
      },
      {
        "name": "100 C Programs for Placements (94 pages)",
        "file_link": "https://drive.google.com/file/d/11FuEP2Zbm7-iBBQ4zCK-aYI4H-4MoONH/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/11FuEP2Zbm7-iBBQ4zCK-aYI4H-4MoONH=s1024?authuser=0"
      },
      {
        "name": "C Arrays Q&amp;A with Explanations",
        "file_link": "https://drive.google.com/file/d/15ITZh-7bZLdJ936zbQT7W41yuGEpaaO1/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/15ITZh-7bZLdJ936zbQT7W41yuGEpaaO1=s1024?authuser=0"
      },
      {
        "name": "Good Interview C Programs and Notes",
        "file_link": "https://drive.google.com/file/d/1Vgef-9usN3Hxl0OWbdUF274oXcHl66Wp/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1Vgef-9usN3Hxl0OWbdUF274oXcHl66Wp=s1024?authuser=0"
      },
      {
        "name": "C Programs Input Output Questions (13 pages)",
        "file_link": "https://drive.google.com/file/d/1m5f639kIZYSJP-u1k62yjIOR6bBwMgE6/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1m5f639kIZYSJP-u1k62yjIOR6bBwMgE6=s1024?authuser=0"
      },
      {
        "name": "All Important C Programs (94 pages)",
        "file_link": "https://drive.google.com/file/d/1AfCOKkveiOhGcrY_RpcRGJki-Cjovjuk/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1AfCOKkveiOhGcrY_RpcRGJki-Cjovjuk=s1024?authuser=0"
      },
      {
        "name": "DSA Handwritten Guide (Beginner to Advanced)",
        "file_link": "https://drive.google.com/file/d/14SKfAIY5wPq0j-aE5cNcGs3DVQaocB3Q/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/14SKfAIY5wPq0j-aE5cNcGs3DVQaocB3Q=s1024?authuser=0"
      },
      {
        "name": "C Programming & Data Structures Handwritten Notes",
        "file_link": "https://drive.google.com/file/d/1u1uKkUFhEUtJBdYl-yhjvSz17AzxeRd8/view?usp=sharing",
        "thumbnail": "https://lh3.googleusercontent.com/d/1u1uKkUFhEUtJBdYl-yhjvSz17AzxeRd8=s1024?authuser=0"
      }
    ]

      }
]

        // DOM Elements
        const pdfContainer = document.getElementById('pdfContainer');
        const categoryAccordion = document.getElementById('categoryAccordion');
        const currentCategory = document.getElementById('currentCategory');
        const searchInput = document.getElementById('searchInput');
        const emptyState = document.getElementById('emptyState');
        const pdfModal = document.getElementById('pdfModal');
        const pdfFrame = document.getElementById('pdfFrame');
        const pdfTitle = document.getElementById('pdfTitle');
        const closePdfModal = document.getElementById('closePdfModal');
        const markAsReadBtn = document.getElementById('markAsReadBtn');
        const totalProgressBar = document.getElementById('totalProgressBar');
        const totalCompletion = document.getElementById('totalCompletion');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebar = document.getElementById('sidebar');
        const closeSidebarBtn = document.getElementById('closeSidebarBtn');
        const expandAllBtn = document.getElementById('expandAllBtn');
        const gridViewBtn = document.getElementById('gridViewBtn');
        const listViewBtn = document.getElementById('listViewBtn');
        const pdfFullscreen = document.getElementById('pdfFullscreen');
        const fullscreenPdfFrame = document.getElementById('fullscreenPdfFrame');
        const fullscreenPdfTitle = document.getElementById('fullscreenPdfTitle');
        const closeFullscreenBtn = document.getElementById('closeFullscreenBtn');

        // State variables
        let currentFilter = 'all';
        let currentSubFilter = '';
        let currentView = 'grid';
        let currentlyViewedPdf = null;
        let progressData = JSON.parse(localStorage.getItem('pdfProgress')) || {};

        // Initialize the app
        function init() {
            renderCategories();
            renderPdfs();
            updateProgress();
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Search functionality
            searchInput.addEventListener('input', debounce(() => {
                renderPdfs();
            }, 300));

            // PDF modal
            closePdfModal.addEventListener('click', closePdfViewer);
            markAsReadBtn.addEventListener('click', togglePdfProgress);

            // Fullscreen PDF viewer
            closeFullscreenBtn.addEventListener('click', closeFullscreenPdfViewer);

            // Mobile menu
            mobileMenuBtn.addEventListener('click', () => sidebar.classList.add('active'));
            closeSidebarBtn.addEventListener('click', () => sidebar.classList.remove('active'));

            // View toggle
            gridViewBtn.addEventListener('click', () => {
                currentView = 'grid';
                updateViewButtons();
                renderPdfs();
            });

            listViewBtn.addEventListener('click', () => {
                currentView = 'list';
                updateViewButtons();
                renderPdfs();
            });

            // Expand all categories
            expandAllBtn.addEventListener('click', toggleAllCategories);
        }

        // Update view toggle buttons
        function updateViewButtons() {
            if (currentView === 'grid') {
                gridViewBtn.classList.remove('text-slate-400', 'bg-slate-800');
                gridViewBtn.classList.add('text-blue-400');
                listViewBtn.classList.remove('text-blue-400');
                listViewBtn.classList.add('text-slate-400', 'bg-slate-800');
            } else {
                listViewBtn.classList.remove('text-slate-400', 'bg-slate-800');
                listViewBtn.classList.add('text-blue-400');
                gridViewBtn.classList.remove('text-blue-400');
                gridViewBtn.classList.add('text-slate-400', 'bg-slate-800');
            }
        }

        // Toggle all categories
        function toggleAllCategories() {
            const isExpanded = expandAllBtn.textContent.includes('Expand');
            
            document.querySelectorAll('.category-item').forEach(item => {
                const subcategoryList = item.querySelector('.subcategory-list');
                const toggleIcon = item.querySelector('.toggle-icon');
                
                if (isExpanded) {
                    subcategoryList.classList.remove('hidden');
                    toggleIcon.classList.remove('fa-plus');
                    toggleIcon.classList.add('fa-minus');
                } else {
                    subcategoryList.classList.add('hidden');
                    toggleIcon.classList.remove('fa-minus');
                    toggleIcon.classList.add('fa-plus');
                }
            });
            
            expandAllBtn.textContent = isExpanded ? 'Collapse All' : 'Expand All';
        }

        // Render category navigation
        function renderCategories() {
            // Get unique categories
            const categories = [...new Set(pdfData.map(item => item.category))];
            
            categories.forEach(category => {
                // Create category item
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                
                // Create category button
                const categoryBtn = document.createElement('button');
                categoryBtn.className = 'w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700 text-left';
                categoryBtn.innerHTML = `
                    <span class="font-medium">${category}</span>
                    <i class="toggle-icon fas fa-plus text-xs text-slate-400"></i>
                `;
                
                // Get subcategories for this category
                const subcategories = [...new Set(
                    pdfData.filter(item => item.category === category).map(item => item.subcategory)
                )];
                
                // Create subcategory list
                const subcategoryList = document.createElement('div');
                subcategoryList.className = 'subcategory-list hidden mt-1 ml-4 space-y-1';
                
                // Add "All" option for the category
                const allSubcategory = document.createElement('button');
                allSubcategory.className = 'w-full text-left p-2 rounded-lg hover:bg-slate-700 text-sm flex items-center';
                allSubcategory.innerHTML = `
                    <i class="fas fa-layer-group mr-2 text-blue-400"></i>
                    <span>All ${category}</span>
                `;
                allSubcategory.addEventListener('click', () => {
                    currentFilter = category;
                    currentSubFilter = '';
                    currentCategory.textContent = category;
                    renderPdfs();
                    closeSidebarOnMobile();
                });
                
                subcategoryList.appendChild(allSubcategory);
                
                // Add each subcategory
                subcategories.forEach(subcategory => {
                    const subcategoryBtn = document.createElement('button');
                    subcategoryBtn.className = 'w-full text-left p-2 rounded-lg hover:bg-slate-700 text-sm flex items-center';
                    subcategoryBtn.innerHTML = `
                        <i class="fas fa-folder mr-2 text-blue-400"></i>
                        <span>${subcategory}</span>
                    `;
                    
                    subcategoryBtn.addEventListener('click', () => {
                        currentFilter = category;
                        currentSubFilter = subcategory;
                        currentCategory.textContent = `${category} > ${subcategory}`;
                        renderPdfs();
                        closeSidebarOnMobile();
                    });
                    
                    subcategoryList.appendChild(subcategoryBtn);
                });
                
                // Toggle subcategories on category click
                categoryBtn.addEventListener('click', () => {
                    const icon = categoryBtn.querySelector('.toggle-icon');
                    
                    if (subcategoryList.classList.contains('hidden')) {
                        subcategoryList.classList.remove('hidden');
                        icon.classList.remove('fa-plus');
                        icon.classList.add('fa-minus');
                    } else {
                        subcategoryList.classList.add('hidden');
                        icon.classList.remove('fa-minus');
                        icon.classList.add('fa-plus');
                    }
                });
                
                // Add "All Resources" button at the top
                if (category === categories[0]) {
                    const allResourcesBtn = document.createElement('button');
                    allResourcesBtn.className = 'w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-700 text-left mb-2 bg-slate-700';
                    allResourcesBtn.innerHTML = `
                        <span class="font-medium text-blue-400">All Resources</span>
                    `;
                    allResourcesBtn.addEventListener('click', () => {
                        currentFilter = 'all';
                        currentSubFilter = '';
                        currentCategory.textContent = 'All Resources';
                        renderPdfs();
                        closeSidebarOnMobile();
                    });
                    
                    categoryAccordion.appendChild(allResourcesBtn);
                }
                
                categoryItem.appendChild(categoryBtn);
                categoryItem.appendChild(subcategoryList);
                categoryAccordion.appendChild(categoryItem);
            });
        }

        // Close sidebar on mobile after selection
        function closeSidebarOnMobile() {
            if (window.innerWidth < 768) {
                sidebar.classList.remove('active');
            }
        }

        // Render PDF cards based on current filter
        function renderPdfs() {
            // Clear existing cards
            pdfContainer.innerHTML = '';
            
            // Filter PDFs based on current selection and search term
            let filteredPdfs = [];
            
            if (currentFilter === 'all') {
                // Show all PDFs
                pdfData.forEach(category => {
                    category.resources.forEach(pdf => {
                        filteredPdfs.push({
                            ...pdf,
                            category: category.category,
                            subcategory: category.subcategory
                        });
                    });
                });
            } else if (currentSubFilter) {
                // Show PDFs from specific subcategory
                pdfData.forEach(category => {
                    if (category.category === currentFilter && category.subcategory === currentSubFilter) {
                        category.resources.forEach(pdf => {
                            filteredPdfs.push({
                                ...pdf,
                                category: category.category,
                                subcategory: category.subcategory
                            });
                        });
                    }
                });
            } else {
                // Show PDFs from specific category
                pdfData.forEach(category => {
                    if (category.category === currentFilter) {
                        category.resources.forEach(pdf => {
                            filteredPdfs.push({
                                ...pdf,
                                category: category.category,
                                subcategory: category.subcategory
                            });
                        });
                    }
                });
            }
            
            // Apply search filter
            const searchTerm = searchInput.value.toLowerCase();
            if (searchTerm) {
                filteredPdfs = filteredPdfs.filter(pdf => 
                    pdf.name.toLowerCase().includes(searchTerm) ||
                    pdf.category.toLowerCase().includes(searchTerm) ||
                    pdf.subcategory.toLowerCase().includes(searchTerm)
                );
            }
            
            // Show empty state if no PDFs match
            if (filteredPdfs.length === 0) {
                emptyState.classList.remove('hidden');
                return;
            } else {
                emptyState.classList.add('hidden');
            }
            
            // Render PDF cards
            filteredPdfs.forEach((pdf, index) => {
                const isComplete = progressData[pdf.name]?.completed || false;
                
                const pdfCard = document.createElement('div');
                pdfCard.className = `animate-card glass-card rounded-xl overflow-hidden shadow-lg transition-all duration-300 hover:shadow-xl hover:translate-y-1 ${currentView === 'grid' ? '' : 'flex'} opacity-0`;
                pdfCard.style.animationDelay = `${index * 0.05}s`;
                
                // Set different layout for grid vs list view
                if (currentView === 'grid') {
                    pdfCard.innerHTML = `
                        <div class="relative">
                            <img src="${pdf.thumbnail || 'https://via.placeholder.com/300x200?text=No+Thumbnail'}" 
                                 alt="${pdf.name}" 
                                 class="w-full h-48 object-cover">
                            <div class="absolute top-2 right-2">
                                <button class="p-2 rounded-full bg-slate-800 bg-opacity-80 text-white hover:bg-blue-600 pdf-view-btn" data-pdf='${JSON.stringify(pdf)}'>
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="p-4">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-semibold text-lg truncate">${pdf.name}</h3>
                                <label class="inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="hidden pdf-checkbox" ${isComplete ? 'checked' : ''} data-pdf="${pdf.name}">
                                    <span class="relative">
                                        <span class="block w-6 h-6 rounded-full ${isComplete ? 'bg-blue-500' : 'bg-slate-700'} border border-slate-600"></span>
                                        ${isComplete ? '<i class="fas fa-check absolute top-1 left-1 text-white text-xs"></i>' : ''}
                                    </span>
                                </label>
                            </div>
                            <div class="flex items-center text-sm text-slate-400 mb-2">
                                <i class="fas fa-tag mr-1"></i>
                                <span>${pdf.category} > ${pdf.subcategory}</span>
                            </div>
                            <div class="flex justify-start items-center text-xs">
                                <button class="pdf-view-btn text-blue-400 hover:text-blue-300 flex items-center" data-pdf='${JSON.stringify(pdf)}'>
                                    <i class="fas fa-external-link-alt mr-1"></i> Open
                                </button>
                            </div>
                        </div>
                    `;
                } else {
                    // List view
                    pdfCard.innerHTML = `
                        <div class="flex-shrink-0 w-32">
                            <img src="${pdf.thumbnail || 'https://via.placeholder.com/300x200?text=No+Thumbnail'}" 
                                 alt="${pdf.name}" 
                                 class="w-full h-full object-cover">
                        </div>
                        <div class="flex-grow p-4 flex flex-col">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <h3 class="font-semibold text-lg">${pdf.name}</h3>
                                    <div class="flex items-center text-sm text-slate-400 mt-1">
                                        <i class="fas fa-tag mr-1"></i>
                                        <span>${pdf.category} > ${pdf.subcategory}</span>
                                    </div>
                                </div>
                                <label class="inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="hidden pdf-checkbox" ${isComplete ? 'checked' : ''} data-pdf="${pdf.name}">
                                    <span class="relative">
                                        <span class="block w-6 h-6 rounded-full ${isComplete ? 'bg-blue-500' : 'bg-slate-700'} border border-slate-600"></span>
                                        ${isComplete ? '<i class="fas fa-check absolute top-1 left-1 text-white text-xs"></i>' : ''}
                                    </span>
                                </label>
                            </div>
                            <div class="mt-auto flex justify-between items-center">
                                <div class="flex space-x-2">
                                    <button class="pdf-view-btn px-3 py-1 rounded-lg bg-blue-600 hover:bg-blue-500 text-white flex items-center" data-pdf='${JSON.stringify(pdf)}'>
                                        <i class="fas fa-eye mr-1"></i> View
                                    </button>
                                </div>
                                <span class="text-xs text-slate-500">Last viewed: ${progressData[pdf.name]?.lastViewed ? formatDate(progressData[pdf.name].lastViewed) : 'Never'}</span>
                            </div>
                        </div>
                    `;
                }
                
                pdfContainer.appendChild(pdfCard);
            });
            
            // Add event listeners to the new elements
            document.querySelectorAll('.pdf-view-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const pdf = JSON.parse(btn.dataset.pdf);
                    openFullscreenPdfViewer(pdf);
                });
            });
            
            document.querySelectorAll('.pdf-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const pdfName = checkbox.dataset.pdf;
                    togglePdfProgress(pdfName);
                });
            });
        }

        // Format date for display
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        // Open PDF viewer in fullscreen
        function openFullscreenPdfViewer(pdf) {
            currentlyViewedPdf = pdf;
            fullscreenPdfFrame.src = pdf.file_link;
            fullscreenPdfTitle.textContent = pdf.name;
            
            // Show fullscreen viewer
            pdfFullscreen.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            
            // Update last viewed time
            if (!progressData[pdf.name]) {
                progressData[pdf.name] = { completed: false };
            }
            progressData[pdf.name].lastViewed = new Date().toISOString();
            localStorage.setItem('pdfProgress', JSON.stringify(progressData));
        }

        // Close fullscreen PDF viewer
        function closeFullscreenPdfViewer() {
            pdfFullscreen.classList.add('hidden');
            document.body.style.overflow = '';
            fullscreenPdfFrame.src = '';
            currentlyViewedPdf = null;
            
            // Re-render PDFs to update last viewed time
            renderPdfs();
        }

        // Close PDF viewer
        function closePdfViewer() {
            pdfModal.classList.remove('active');
            document.body.style.overflow = '';
            pdfFrame.src = '';
            currentlyViewedPdf = null;
        }

        // Toggle PDF progress (mark as read/unread)
        function togglePdfProgress(pdfName) {
            const pdfToUpdate = pdfName || currentlyViewedPdf?.name;
            if (!pdfToUpdate) return;
            
            if (!progressData[pdfToUpdate]) {
                progressData[pdfToUpdate] = { completed: true };
            } else {
                progressData[pdfToUpdate].completed = !progressData[pdfToUpdate].completed;
            }
            
            // Update completion date if marking as complete
            if (progressData[pdfToUpdate].completed) {
                progressData[pdfToUpdate].completedDate = new Date().toISOString();
            }
            
            localStorage.setItem('pdfProgress', JSON.stringify(progressData));
            updateProgress();
            
            // Re-render PDFs to update checkboxes
            renderPdfs();
        }

        // Update progress bar and completion percentage
        function updateProgress() {
            // Count total PDFs and completed PDFs
            let totalPdfs = 0;
            let completedPdfs = 0;
            
            pdfData.forEach(category => {
                category.resources.forEach(pdf => {
                    totalPdfs++;
                    if (progressData[pdf.name]?.completed) {
                        completedPdfs++;
                    }
                });
            });
            
            // Calculate percentage
            const percentage = totalPdfs > 0 ? Math.round((completedPdfs / totalPdfs) * 100) : 0;
            
            // Update UI
            totalProgressBar.style.width = `${percentage}%`;
            totalCompletion.textContent = `${percentage}%`;
        }

        // Debounce function for search input
        function debounce(func, wait) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    func.apply(context, args);
                }, wait);
            };
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

